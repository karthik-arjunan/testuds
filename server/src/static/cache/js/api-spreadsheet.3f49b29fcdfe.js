// Generated by CoffeeScript 1.12.7
(function() {
  "use strict";
  var $, ref, ref1;

  this.api = (ref = this.api) != null ? ref : {};

  this.api.spreadsheet = (ref1 = this.api.spreadsheet) != null ? ref1 : {};

  $ = jQuery;

  this.api.spreadsheet.cell = function(data, type, style) {
    type = type || "String";
    if (style != null) {
      style = " ss:StyleID=\"" + style + "\"";
    } else {
      style = "";
    }
    return "<Cell" + style + "><Data ss:Type=\"" + type + "\">" + data + "</Data></Cell>";
  };

  this.api.spreadsheet.row = function(cell) {
    return "<Row>" + cell + "</Row>";
  };

  this.api.spreadsheet.tableToExcel = (function() {
    var content_type, format, template, uri;
    content_type = "application/vnd.ms-excel";
    uri = "data:application/vnd.ms-excel;base64,";
    template = "<html xmlns:o=\"urn:schemas-microsoft-com:office:office\" xmlns:x=\"urn:schemas-microsoft-com:office:excel\" xmlns=\"http://www.w3.org/TR/REC-html40\"><head><meta charset=\"utf-8\"><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--></head><body><table>{table}</table></body></html>";
    format = function(s, c) {
      return s.replace(/{(\w+)}/g, function(m, p) {
        return c[p];
      });
    };
    return function(table, name) {
      var content, ctx, iDisplayLength, settings, tbl;
      if (!table.nodeType) {
        table = document.getElementById(table);
      }
      tbl = $(table).dataTable().api();
      settings = tbl.settings()[0];
      iDisplayLength = settings._iDisplayLength;
      settings._iDisplayLength = -1;
      tbl.draw();
      ctx = {
        worksheet: name || "Worksheet",
        table: table.innerHTML
      };
      content = format(template, ctx);
      settings._iDisplayLength = iDisplayLength;
      tbl.draw();
      setTimeout((function() {
        return saveAs(new Blob([content], {
          type: content_type
        }), name + '.xls');
      }), 100);
    };
  })();

  return;

}).call(this);
